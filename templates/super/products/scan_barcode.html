{% extends 'components/base.html' %}
{% load static %}

{% block title %}
    {{ title }}
{% endblock %}

{% block content %}
    <div class="bg-white p-6 rounded-lg shadow-lg flex flex-col items-center">
        <i class="bx bx-barcode-reader text-4xl text-blue-700 mb-4"></i>
        <h3 class="text-xl font-semibold text-black-700 mb-2">{{ title }}</h3>
        <p class="text-center mb-4">Escanear los productos para visualizar los precios.</p>
        <button id="openModal" class="text-green-700 hover:text-white border border-blue-700 hover:bg-green-700 px-4 py-2 rounded-full transition-all duration-200">
            Escanear Productos
        </button>
    </div>

    <!-- Modal para el escáner -->
    <div id="scannerModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden">
        <div class="bg-white p-6 rounded-lg shadow-lg w-11/12 max-w-md">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold text-black-700">Escanear Productos</h3>
                <button id="closeModal" class="text-gray-700 hover:text-gray-900 text-2xl">×</button>
            </div>
            <div class="relative w-full h-64 bg-gray-200 mb-4">
                <video id="cameraView" class="w-full h-full" autoplay></video>
                <div id="barcodeOverlay" class="absolute border-4 border-red-500 rounded-lg transition-colors duration-300" style="top: 25%; left: 25%; width: 50%; height: 50%;"></div>
            </div>
            <p class="text-center mb-4">Apunta la cámara al código de barras del producto.</p>
        </div>
    </div>

    <!-- Modal para mostrar el resultado del escaneo -->
    <div id="resultModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden">
        <div class="bg-white p-6 rounded-lg shadow-lg w-11/12 max-w-md">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold text-black-700">Resultado del Escaneo</h3>
                <button id="closeResultModal" class="text-gray-700 hover:text-gray-900 text-2xl">×</button>
            </div>
            <div id="resultContent" class="text-center">
                <!-- Contenido dinámico se insertará aquí desde JavaScript -->
            </div>
        </div>
    </div>

    <!-- Script -->
    <script src="{% static 'js/scan_barcode.js' %}"></script>
{% endblock %}

