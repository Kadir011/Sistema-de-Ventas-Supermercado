{% extends 'components/base.html' %}
{% block title %}{{ title }}{% endblock %}
{% block content %}
<div class="container mx-auto py-8 px-16">
    <div class="bg-white shadow-lg rounded-lg overflow-hidden">
        <div class="relative">
            <!-- Imágen del Producto -->
            <div class="w-full h-72 overflow-hidden">
                <img src="{{ product.get_image_url }}" alt="{{ product.name }}" class="w-full h-full object-contain">
            </div> 
            <div class="absolute top-4 left-4 text-white bg-opacity-70 bg-black p-2 rounded-lg">
                <h1 class="text-3xl font-bold">{{ product.name }}</h1> 
            </div> 
        </div> 
        <div class="p-6">
            <p class="text-lg text-gray-700 mb-4">{{ product.description|truncatewords:20 }}</p>
            <p class="text-xl font-semibold text-green-600 mb-4">{{ product.price|floatformat:2 }}$</p>
            <p class="text-gray-500 mb-2"><strong>Categoría:</strong> {{ product.category.name }}</p>
            <p class="text-gray-500 mb-2"><strong>Marca:</strong> {{ product.brand.name }}</p>
            <p class="text-gray-500 mb-6"><strong>Stock:</strong> {{ product.stock }}</p>
            <p class="text-gray-500 mb-6"><strong>Fecha de Elaboración:</strong> {{ product.production_date|date:'d/m/Y' }}</p>
            <p class="text-gray-500 mb-6"><strong>Fecha de Vencimiento:</strong> {{ product.expiration_date|date:'d/m/Y' }}</p>
            <p class="text-gray-500 mb-6"><strong>Estado:</strong> {{ product.state|yesno:'Disponible,Agotado' }}</p>
            <p class="text-gray-500 mb-6">
                {% if product.barcode %}
                    <svg id="barcode-{{ product.id }}" class="border border-green-600 rounded-lg"></svg>
                {% else %}
                    <span class="text-white-600 font-bold border border-green-600 rounded-lg px-2 py-1">Barcode no registrado</span>
                {% endif %}
            </p>
            <!-- Buttons Section (only for superusers) -->
            {% if user.is_superuser %}
                <div class="flex justify-between items-center space-x-4">
                    <!-- Edit Product -->
                    <a href="{% url 'super:product_update' product.pk %}" class="bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition-all">Editar Producto</a>
                    <!-- Delete Product -->
                    <a href="{% url 'super:product_delete' product.pk %}" class="bg-red-500 text-white px-6 py-2 rounded-lg hover:bg-red-600 transition-all">Eliminar Producto</a>
                </div> 
            {% endif %}

            <!-- Back to List -->
            <div class="mt-4">
                <a href="{{back_url}}" class="bg-gray-300 text-black px-6 py-2 rounded-lg hover:bg-gray-400 transition-all">Volver a la Lista</a>
            </div>
        </div> 
    </div> 
</div> 
<script>
    // Script para visualizar el código de barras 
    document.addEventListener('DOMContentLoaded', function () {
        const barcodeValue = "{{ product.barcode }}"; // El valor del código de barras 

        if (barcodeValue) {
            JsBarcode("#barcode-{{ product.id }}", barcodeValue, {
                format: "EAN13", // Formato del código de barras
                lineColor: "#000", // Color de las líneas
                width: 2,          // Anchura de las barras
                height: 50,        // Altura del código de barras
                displayValue: true // Mostrar el número debajo
            }); 
        } 
    }); 
    console.log("Barcode value:", barcodeValue);
</script> 
{% endblock %}




